<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mapa Conceptual ‚Äî Semilleros</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üå±</text></svg>">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Caveat:wght@700&family=Indie+Flower&family=Permanent+Marker&family=Shadows+Into+Light&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@600;700&family=Nunito:wght@700;800&family=Fredoka:wght@600&family=Comfortaa:wght@700&display=swap" rel="stylesheet">
 <style>
    *{box-sizing:border-box;margin:0;padding:0}
    html,body,#app{height:100%}

  body{
  font-family: "Poppins", sans-serif;
  background: 
    linear-gradient(90deg, rgba(200,200,200,0.15) 1px, transparent 1px),
    linear-gradient(rgba(200,200,200,0.15) 1px, transparent 1px),
    linear-gradient(90deg, rgba(150,150,150,0.08) 1px, transparent 1px),
    linear-gradient(rgba(150,150,150,0.08) 1px, transparent 1px),
    #f8f9fa;
  background-size: 20px 20px, 20px 20px, 100px 100px, 100px 100px;
  background-position: -1px -1px, -1px -1px, -1px -1px, -1px -1px;
  color: #0f172a;
  overflow:hidden;
    }

    /* Header */
   .header{
  padding:10px 24px 18px;
  background:transparent;
  display:flex;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  border-bottom:3px solid #ff006e;
  border-bottom-style: dashed;
}
.brand h1{
  font-size:50px;
  font-weight:800;
  color:transparent;
  text-align:center;
  letter-spacing:2px;
  background: linear-gradient(135deg, #ff006e 0%, #ffbe0b 25%, #fb5607 50%, #8338ec 75%, #3a86ff 100%);
  background-clip: text;
  -webkit-background-clip: text;
font-family: 'Indie Flower', cursive;

  text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
  filter: drop-shadow(0 4px 8px rgba(255,0,110,0.3));
}
.brand p{
  font-size:20px;
  color:#334155;
  text-align:center;
font-family: 'Shadows Into Light', cursive;
  font-style: italic;

}
    .main{flex:1;display:flex;overflow:hidden;position:relative}
    .canvas-wrapper{
  flex:1;
  position:relative;
  padding:20px;
  overflow:hidden;
  cursor: grab;
}
.canvas-wrapper.dragging{
  cursor: grabbing;
}
    svg#mapCanvas{width:100%;height:100%;display:block}

    /* Control bar */
    .control-bar{
      position:fixed;right:20px;bottom:20px;
      display:flex;gap:10px;align-items:center;z-index:80
    }
    .btn{
      background:rgba(255,255,255,0.9);
      border:1px solid rgba(15,23,42,0.06);
      padding:10px 14px;
      border-radius:12px;
      cursor:pointer;
      font-weight:600;
      box-shadow:0 6px 18px rgba(11,18,32,0.06);
      transition:transform .12s ease,box-shadow .12s ease;
    }
    .btn:hover{transform:translateY(-3px);box-shadow:0 10px 30px rgba(11,18,32,0.08)}
    .zoom-indicator{
      background:linear-gradient(180deg,rgba(255,255,255,0.8),rgba(255,255,255,0.7));
      padding:8px 10px;border-radius:10px;border:1px solid rgba(15,23,42,0.04);font-size:13px
    }

    /* Instructions */
  /* Caja de instrucciones */
.instructions {
  position: fixed;
  left: 20px;
  bottom: 20px;
  z-index: 90;
  max-width: 320px;
  border-radius: 14px;
  padding: 12px;
  background: rgba(255, 255, 255, 0.55);
  backdrop-filter: blur(8px);
  box-shadow: 0 10px 30px rgba(11, 18, 32, 0.06);
  border: 1px solid rgba(11, 18, 32, 0.06);
  transition: all 0.4s ease;
}

.instructions .head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}

.instructions h3 {
  font-size: 14px;
  color: #0b1220;
}

.instructions p {
  font-size: 12px;
  color: #475569;
  margin-top: 6px;
}

.instructions ul {
  margin-top: 8px;
  font-size: 13px;
  color: #334155;
  list-style: none;
}

.instructions li {
  margin-bottom: 6px;
}

/* Estado minimizado */
.instructions.collapsed {
  width: 60px;
  height: 60px;
  padding: 0;
  border-radius: 50%;
 background:  #3a86ff;
 opacity:80% ;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 0 20px rgba(34, 197, 94, 0.6);
  cursor: pointer;
  animation: pulse 1.5s infinite;
}

/* Efecto de pulso */
@keyframes pulse {
  0% {
    box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.6);
  }
  70% {
    box-shadow: 0 0 0 12px rgba(34, 197, 94, 0);
  }
  100% {
    box-shadow: 0 0 0 0 rgba(34, 197, 94, 0);
  }
}

/* Ocultar contenido cuando est√° colapsado */
.instructions.collapsed .head,
.instructions.collapsed ul {
  display: none;
}

/* Emoji de ayuda visible en modo colapsado */
.instructions::after {
  content: "";
}

.instructions.collapsed::after {
  content: "üí°";
  font-size: 28px;
  color: white;
}



    /* Modal */
    .modal{position:fixed;inset:0;display:none;align-items:flex-start;justify-content:center;padding:28px;z-index:120}
    .modal.active{display:flex}
    .modal-backdrop{position:absolute;inset:0;background:rgba(10,15,25,0.35);backdrop-filter: blur(3px)}
    .modal-card{
      position:relative;z-index:10;width:min(640px,96%);
      border-radius:18px;overflow:hidden;
      border:1px solid rgba(11,18,32,0.08);
      box-shadow:0 30px 60px rgba(11,18,32,0.15);
      background:linear-gradient(180deg,rgba(255,255,255,0.96),rgba(250,250,250,0.9));
      backdrop-filter: blur(6px);
      transform: translateY(20px);
      animation: fadeIn 0.3s ease forwards;
    }
    @keyframes fadeIn {
      to { transform: translateY(0); opacity: 1; }
    }

    .modal-header{
      padding:20px;cursor:grab;display:flex;align-items:center;gap:14px;
      background: linear-gradient(135deg, #ffbe0b 0%, #fb5607 40%, #8338ec 100%);
      color:#fff;
    }
    .modal-emoji{font-size:28px}
    .modal-title{font-weight:700;font-size:25px; font-family: 'Quicksand', sans-serif;}
    .modal-body{
      padding:18px 24px 24px;
      color:#0f172a;font-size:15px;line-height:1.6;
       font-size: 15px;
  line-height: 1.6;
  font-family: 'Quicksand', sans-serif;
    }
    .modal-body h4 {
      font-size:17px;
      font-weight:700;
      margin-bottom:8px;
      color:#0f172a;
      display:flex;align-items:center;gap:6px;
      font-family: 'Quicksand', sans-serif;
    }
    .modal-body p {
      margin-bottom:10px;
      color:#334155;
      font-family: 'Quicksand', sans-serif;
    }
    .modal-body ul {
      list-style:none;padding-left:14px;
    }
 .modal-body ul {
  list-style: none;
  padding-left: 0;
  margin-top: 16px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.modal-body li {
  position: relative;
  padding: 12px 16px 12px 48px;
  color: #1e293b;
  font-size: 14px;
  line-height: 1.6;
  background: linear-gradient(135deg, rgba(255, 190, 11, 0.08), rgba(131, 56, 236, 0.08));
  border-radius: 8px;
  transition: all 0.3s ease;
  font-weight: 500;
  font-family: 'Quicksand', sans-serif;
  overflow: hidden;
}

.modal-body li::after {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 4px;
  background: linear-gradient(to bottom, #ff006e 0%, #ffbe0b 25%, #fb5607 50%, #8338ec 75%, #3a86ff 100%);
}

.modal-body li:hover {
  transform: translateX(8px);
  background: linear-gradient(135deg, rgba(255, 190, 11, 0.15), rgba(131, 56, 236, 0.15));
  box-shadow: 0 4px 12px rgba(131, 56, 236, 0.2);
}

.modal-body li::before {
  content: "üåø";
  position: absolute;
  left: 14px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 20px;
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
  z-index: 1;
}
    .modal-footer {
      padding:14px 20px;
      display:flex;justify-content:flex-end;
    }
    .btn-primary {
      background:#0f172a;
      color:#fff;
      padding:10px 16px;
      border:none;
      border-radius:10px;
      cursor:pointer;
      transition: all 0.2s ease;
    }
    .btn-primary:hover {
      background:#1e293b;
      transform:scale(1.04);
    }
    .emoji-badge{font-size:16px}

  .connector-label{
  font-size: 13px;
  margin-left: 30px;
  fill: #8338ec;
  font-weight: 500;
  transform: translateY(9px);
  cursor: pointer;
  transition: all 0.3s ease;
  filter: drop-shadow(0 2px 4px rgba(131, 56, 236, 0.3));
}

.connector-label:hover{
  fill: #ff006e;
  font-size: 15px;
  font-weight: 700;
  filter: drop-shadow(0 4px 10px rgba(255, 0, 110, 0.6));
  transform: translateY(9px) ;
}

    @media (max-width:720px){
      .instructions{max-width:90%;left:10px;bottom:10px}
      .control-bar{right:10px;bottom:10px}
    }
    .emoji-badge {
  font-size: 20px;
  pointer-events: none;
}

.node-shape {
  transition: transform 0.3s ease, filter 0.3s ease;
}

.node-shape:hover {
  filter: brightness(1.1);
}

  </style>>
</head>
<body>
  <div id="app">
    <header class="header">
      <div class="brand">
        <h1>üåø Semilleros de Investigaci√≥n üåø</h1>
        <p>UNA PR√ÅCTICA 
PARA EL DESARROLLO CIENT√çFICO DE LAS NACIONES</p>
      </div>
    </header>

    <main class="main">
      <div class="canvas-wrapper" id="canvasWrapper">
        <svg id="mapCanvas" viewBox="0 0 1100 700"></svg>
      </div>
    </main>

  <aside class="instructions" id="instructions">
  <div class="head">
    <div>
      <h3>Instrucciones</h3>
      <p>Pulsa los nodos para ver detalles. Usa los botones de zoom.</p>
    </div>
    <div>
      <button class="btn" id="minimizeBtn" title="Minimizar/Expandir">‚Äî</button>
    </div>
  </div>
  <ul style="margin-top:10px">
    <li><strong>Arrastrar:</strong> Mueve el mapa</li>
    <li><strong>Zoom:</strong> + / -</li>
    <li><strong>Nodos:</strong> Conceptos y subconceptos</li>
  </ul>
</aside>


    <div class="control-bar">
      <button class="btn" onclick="zoomIn()">‚ûï</button>
      <button class="btn" onclick="zoomOut()">‚ûñ</button>
      <button class="btn" onclick="resetView()">‚Ü∫</button>
      <div class="zoom-indicator">Zoom: <span id="zoomPercent">100</span>%</div>
    </div>

    <div class="modal" id="modal">
      <div class="modal-backdrop" id="modalBackdrop"></div>
      <div class="modal-card" id="modalCard">
        <div class="modal-header" id="modalHeader">
          <div class="modal-emoji" id="modalEmoji">üå±</div>
          <div>
            <div class="modal-title" id="modalTitle">T√≠tulo</div>
            <div style="font-size:13px;color:#475569" id="modalSubtitle"></div>
          </div>
        </div>
        <div class="modal-body"><p id="modalBody">Contenido‚Ä¶</p></div>
        <div class="modal-footer"><button class="btn-primary" id="modalClose">Cerrar</button></div>
      </div>
    </div>
  </div>

  <script>
    const nodes = [
      { id: 'main', label: 'Semilleros de Investigaci√≥n', x: 500, y: 90, shape: 'rect', color: '#ffbe0b', emoji: 'üå±', info: {
          title: 'Semilleros de Investigaci√≥n',
          description: 'Espacios de formaci√≥n acad√©mica e investigativa que permiten incentivar la conformaci√≥n de grupos acad√©micos para debatir y discutir problemas e ideas que aporten al trabajo investigativo.',
          details: [
            'Espacios autogestionados de formaci√≥n',
            'Integrados por estudiantes, docentes e investigadores',
            'Fomentan el esp√≠ritu cient√≠fico',
            'Construcci√≥n colectiva de conocimiento',
            'Responden a exigencias de la sociedad'
          ]
        } },
      { id: 'caracteristicas', label: 'Caracter√≠sticas', x: 200, y: 200, shape: 'oval', color: '#fb5607', emoji: '‚ú®', info: {
     
                    title: 'Caracter√≠sticas',
                    description: 'Los semilleros son espacios autogestionados que otorgan gran libertad de acci√≥n a sus miembros para fomentar el esp√≠ritu cient√≠fico.',
                    details: [
                        'Espacios autogestionados',
                        'Investigaci√≥n formativa',
                        'Trabajo en red',
                        'Di√°logo y publicaciones',
                        'Estructura curricular definida',
                        'Libertad de acci√≥n para sus miembros'
                    ]
                }
            },
      { id: 'objetivos', label: 'Origen e Historia', x: 500, y: 200, shape: 'oval', color: '#fb5607', emoji: 'üåç', info: {
                    title: 'Origen e Historia',
                    description: 'El movimiento de semilleros surge en Colombia en 1996 como estrategia para fomentar el quehacer cient√≠fico dentro de las instituciones universitarias.',
                    details: [
                        'Surge en Colombia en 1996',
                        'Se expande a Am√©rica Latina',
                        'Adoptado por Ecuador, Per√∫, M√©xico y Venezuela',
                        'Inspirado en experiencias europeas',
                        'Estrategia para fortalecer producci√≥n cient√≠fica'
                    ]
                } },
      { id: 'impacto', label: 'Impacto Cient√≠fico', x: 800, y: 200, shape: 'oval', color: '#fb5607', emoji: 'üìä', info: {
  title: 'Impacto Cient√≠fico',
  description: 'Los semilleros de investigaci√≥n han contribuido significativamente al fortalecimiento de la cultura cient√≠fica, la generaci√≥n de nuevo conocimiento y la consolidaci√≥n de comunidades acad√©micas en distintas √°reas del saber.',
  details: [
    'Aumento en publicaciones cient√≠ficas',
                        'Mejora en rankings Scimago',
                        'Colombia: 12,651 documentos (2018)',
                        'M√©xico: 81,742 documentos (2018)',
                        'Formaci√≥n de nuevos investigadores',
                        'Reconocimiento internacional'
  ]
}
 },
      { id: 'estructura', label: 'Estructura Curricular', x: 110, y: 340, shape: 'oval', color: '#ff006e', emoji: 'üî¨', info: {
                    title: 'Estructura Curricular',
                    description: 'Desarrollo de proyectos de investigaci√≥n, publicaciones cient√≠ficas y participaci√≥n en eventos acad√©micos.',
                    details: [
                        'Desarrollo de proyectos de investigaci√≥n',
                        'Publicaci√≥n de art√≠culos cient√≠ficos',
                        'Participaci√≥n en congresos y seminarios',
                        'Conformaci√≥n de redes cient√≠ficas',
                        'Eventos regionales, nacionales e internacionales',
                        'Publicaci√≥n de ensayos y libros'
                    ]
                }},
      { id: 'participantes', label: 'Participantes', x: 300, y: 340, shape: 'rect', color: '#ff006e', emoji: 'üë•',  info: {
                    title: 'Participantes',
                    description: 'Los semilleros est√°n integrados por personas interesadas en hacer de la investigaci√≥n su estilo de vida.',
                    details: [
                        'Estudiantes de pregrado',
                        'Estudiantes de postgrado',
                        'Docentes investigadores',
                        'Tutores y asesores',
                        'Personas motivadas por problemas del entorno'
                    ]
                } },
      { id: 'paises', label: 'Expansi√≥n en Am√©rica Latina', x: 500, y: 340, shape: 'rect', color: '#ff006e', emoji: 'üåé', info: {
                    title: 'Pa√≠ses Latinoamericanos',
                    description: 'Implementaci√≥n en varios pa√≠ses de Am√©rica Latina con diferentes niveles de desarrollo.',
                    details: [
                        'Colombia: 22 art√≠culos - L√≠der regional (5to lugar Scimago)',
                        'M√©xico: 15 art√≠culos - Segundo lugar (81,742 documentos 2018)',
                        'Ecuador: 6 art√≠culos - Crecimiento sostenido (6to lugar)',
                        'Per√∫: 3 art√≠culos - En desarrollo (7mo lugar)',
                        'Venezuela: 4 art√≠culos - Tendencia fluctuante'
                    ]
                } },
      { id: 'produccion', label: 'Producci√≥n Cient√≠fica', x: 700, y: 340, shape: 'oval', color: '#ff006e', emoji: 'üìö', info: {
    title: 'üìö Producci√≥n Cient√≠fica',
    description: 'Los semilleros de investigaci√≥n impulsan la generaci√≥n de conocimiento mediante la publicaci√≥n de art√≠culos, ponencias, libros y proyectos que contribuyen al desarrollo cient√≠fico y acad√©mico de las instituciones.',
    details: [
      'Publicaci√≥n de art√≠culos en revistas acad√©micas y cient√≠ficas',
      'Participaci√≥n en congresos, simposios y ferias de investigaci√≥n',
      'Producci√≥n de libros, cap√≠tulos y memorias investigativas',
      'Difusi√≥n del conocimiento a nivel nacional e internacional',
      'Fortalecimiento de la visibilidad institucional y cient√≠fica'
    ]
  }},
      { id: 'beneficios', label: 'Beneficios', x: 920, y: 340, shape: 'rect', color: '#ff006e', emoji: 'üèÜ', info: {
                    title: ' Beneficios',
                    description: 'Desarrollo cient√≠fico, formaci√≥n investigativa y progreso socio-econ√≥mico de las naciones.',
                    details: [
                        'Desarrollo de competencias investigativas',
                        'Fortalecimiento de cultura cient√≠fica',
                        'Reducci√≥n de dependencia tecnol√≥gica',
                        'Innovaci√≥n y desarrollo industrial',
                        'Transformaci√≥n social',
                        'Mejoramiento de calidad de vida'
                    ]
                }},
      { id: 'metodologia', label: 'Metodolog√≠a ', x: 200, y: 480, shape: 'oval', color: '#8338ec', emoji: 'üî¨',   info: {
    title: ' Metodolog√≠a de Trabajo',
    description: 'Los semilleros de investigaci√≥n emplean metodolog√≠as activas e interdisciplinarias que promueven el aprendizaje colaborativo, la creatividad y la aplicaci√≥n pr√°ctica del conocimiento en la soluci√≥n de problemas reales.',
    details: [
      'Aprendizaje basado en proyectos y problemas reales',
      'Trabajo colaborativo entre estudiantes y docentes',
      'Integraci√≥n de distintas √°reas del conocimiento',
      'Uso de m√©todos cualitativos y cuantitativos',
      'Promoci√≥n de la innovaci√≥n y la investigaci√≥n aplicada'
    ]
  } },
      { id: 'desafios', label: 'Desaf√≠os', x: 500, y: 480, shape: 'rect', color: '#8338ec', emoji: '‚ö†Ô∏è', info:{
        title: 'Desaf√≠os de los Semilleros de Investigaci√≥n',
    description: 'A pesar de su impacto positivo, los semilleros enfrentan retos relacionados con la sostenibilidad, la financiaci√≥n y la continuidad de los proyectos de investigaci√≥n.',
    details: [
      'Limitaciones en el acceso a recursos econ√≥micos',
      'Dificultades para mantener la participaci√≥n activa de los estudiantes',
      'Necesidad de mayor reconocimiento institucional',
      'Escasa articulaci√≥n con redes nacionales e internacionales',
      'Retos en la publicaci√≥n y visibilizaci√≥n de resultados cient√≠ficos'
    ]
      } },
      { id: 'perspectivas', label: 'Inversion en I+D', x: 800, y: 480, shape: 'oval', color: '#3a86ff', emoji: 'üí∞ ',  info: {
                    title: 'Inversi√≥n en I+D',
                    description: 'Los pa√≠ses de Am√©rica Latina han aumentado significativamente su inversi√≥n en investigaci√≥n y desarrollo en relaci√≥n al PIB.',
                    details: [
                        'M√©xico, Colombia, Ecuador y Per√∫ aumentaron gasto en I+D',
                        'Mayor parte de inversi√≥n proviene del Estado',
                        'Recursos destinados a universidades p√∫blicas',
                        'Nuevos lineamientos y pol√≠ticas de financiamiento',
                        'Contrarrestar dependencia tecnol√≥gica'
                    ]
                } }
    ];

    const connections = [
      { from: 'main', to: 'caracteristicas', label: 'posee' },
      { from: 'main', to: 'objetivos', label: 'tiene' },
      { from: 'main', to: 'impacto', label: 'genera' },
      { from: 'caracteristicas', to: 'estructura', label: 'desarrolla' },
      { from: 'caracteristicas', to: 'participantes', label: 'integra' },
      { from: 'objetivos', to: 'paises', label: 'impulsa' },
      { from: 'objetivos', to: 'produccion', label: 'promueve' },
      { from: 'impacto', to: 'beneficios', label: 'permite' },
      { from: 'estructura', to: 'metodologia', label: 'aplica' },
      { from: 'participantes', to: 'produccion', label: 'generan' },
      { from: 'paises', to: 'desafios', label: 'enfrenta' },
      { from: 'produccion', to: 'beneficios', label: 'otorga' },
      { from: 'desafios', to: 'perspectivas', label: 'requiere' }
    ];

    let scale=1, panX=0, panY=0, isDragging=false, dragStartX=0, dragStartY=0;
    const svg=document.getElementById('mapCanvas'), wrapper=document.getElementById('canvasWrapper');

  function drawMap() {
  svg.innerHTML = '';
  const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');
  const marker = document.createElementNS('http://www.w3.org/2000/svg', 'marker');
  marker.setAttribute('id', 'arrowhead');
  marker.setAttribute('markerWidth', '10');
  marker.setAttribute('markerHeight', '10');
  marker.setAttribute('refX', '8');
  marker.setAttribute('refY', '3');
  marker.setAttribute('orient', 'auto');
  const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
  path.setAttribute('d', 'M0,0 L10,3 L0,6 Z');
  path.setAttribute('fill', '#8338ec');
  path.setAttribute('opacity', '0.7');
  marker.appendChild(path);
  defs.appendChild(marker);
  svg.appendChild(defs);

  const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
  g.setAttribute('transform', `translate(${panX},${panY}) scale(${scale})`);

  // === DIBUJAR CONEXIONES ===
  connections.forEach(conn => {
    const a = nodes.find(n => n.id === conn.from), b = nodes.find(n => n.id === conn.to);
    if (!a || !b) return;
    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
    line.setAttribute('x1', a.x);
    line.setAttribute('y1', a.y);
    line.setAttribute('x2', b.x);
    line.setAttribute('y2', b.y);
   line.setAttribute('stroke', '#495057'); // 
line.setAttribute('stroke-width', 1); // üëà M√ÅS GRUESA
line.setAttribute('opacity', '0.7');
line.setAttribute('marker-end', 'url(#arrowhead)');

    g.appendChild(line);

    const midX = (a.x + b.x) / 2, midY = (a.y + b.y) / 2;
    const t = document.createElementNS('http://www.w3.org/2000/svg', 'text');
    t.setAttribute('x', midX);
    t.setAttribute('y', midY - 8);
    t.setAttribute('text-anchor', 'middle');
    t.setAttribute('class', 'connector-label');
    t.textContent = conn.label;
    g.appendChild(t);
  });

  // === DIBUJAR NODOS ===
  nodes.forEach(node => {
    const group = document.createElementNS('http://www.w3.org/2000/svg', 'g');
    group.setAttribute('transform', `translate(${node.x},${node.y})`);
    group.style.cursor = 'pointer';
    group.addEventListener('click', () => showModal(node));

    let width = 180, height = 84;
    let shapeEl;

    if (node.shape === 'circle') {
      shapeEl = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
      shapeEl.setAttribute('r', 48);
    } else if (node.shape === 'oval') {
      shapeEl = document.createElementNS('http://www.w3.org/2000/svg', 'ellipse');
      shapeEl.setAttribute('rx', 70);
      shapeEl.setAttribute('ry', 36);
    } else {
      shapeEl = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
      shapeEl.setAttribute('x', -90);
      shapeEl.setAttribute('y', -42);
      shapeEl.setAttribute('width', 180);
      shapeEl.setAttribute('height', 84);
      shapeEl.setAttribute('rx', 12);
    }

    shapeEl.setAttribute('fill', node.color);
    shapeEl.setAttribute('class', 'node-shape');
    group.appendChild(shapeEl);

    // emoji centrado dentro del nodo
const emoji = document.createElementNS('http://www.w3.org/2000/svg', 'text');
emoji.textContent = node.emoji || '';
emoji.setAttribute('text-anchor', 'middle');
emoji.setAttribute('dominant-baseline', 'middle');
emoji.setAttribute('x', 0);
emoji.setAttribute('y', -25); // un poco m√°s arriba del texto
emoji.setAttribute('class', 'emoji-badge');
group.appendChild(emoji);

    // Etiqueta centrada
    const fo = document.createElementNS('http://www.w3.org/2000/svg', 'foreignObject');
    fo.setAttribute('x', -width / 2);
    fo.setAttribute('y', -height / 2);
    fo.setAttribute('width', width);
    fo.setAttribute('height', height);
    const div = document.createElement('div');
    div.style.width = '100%';
    div.style.height = '100%';
    div.style.display = 'flex';
    div.style.alignItems = 'center';
    div.style.justifyContent = 'center';
    div.style.fontFamily = 'Quicksand, sans-serif'; 
    div.style.fontSize = '13px';
    div.style.fontWeight = '700';
    div.style.textAlign = 'center';
    div.style.color = '#071126';
    div.textContent = node.label;
    fo.appendChild(div);
    group.appendChild(fo);

    g.appendChild(group);
  });

  svg.appendChild(g);
}

drawMap(); // ‚Üê ‚úÖ MUY IMPORTANTE: llama la funci√≥n al cargar

      svg.innerHTML='';
      const defs=document.createElementNS('http://www.w3.org/2000/svg','defs');
      const marker=document.createElementNS('http://www.w3.org/2000/svg','marker');
      marker.setAttribute('id','arrowhead');marker.setAttribute('markerWidth','10');
      marker.setAttribute('markerHeight','10');marker.setAttribute('refX','8');
      marker.setAttribute('refY','3');marker.setAttribute('orient','auto');
      const path=document.createElementNS('http://www.w3.org/2000/svg','path');
      path.setAttribute('d','M0,0 L10,3 L0,6 Z');path.setAttribute('fill','#94a3b8');
      path.setAttribute('opacity','0.7');marker.appendChild(path);
      defs.appendChild(marker);svg.appendChild(defs);

      const g=document.createElementNS('http://www.w3.org/2000/svg','g');
      g.setAttribute('transform',`translate(${panX},${panY}) scale(${scale})`);

      connections.forEach(conn=>{
        const a=nodes.find(n=>n.id===conn.from), b=nodes.find(n=>n.id===conn.to);
        const line=document.createElementNS('http://www.w3.org/2000/svg','line');
        line.setAttribute('x1',a.x);line.setAttribute('y1',a.y);
        line.setAttribute('x2',b.x);line.setAttribute('y2',b.y);
        line.setAttribute('stroke','#cbd5e1');line.setAttribute('stroke-width',2);
        line.setAttribute('marker-end','url(#arrowhead)');
        g.appendChild(line);

        const midX=(a.x+b.x)/2, midY=(a.y+b.y)/2;
        const t=document.createElementNS('http://www.w3.org/2000/svg','text');
        t.setAttribute('x',midX);t.setAttribute('y',midY-8);
        t.setAttribute('text-anchor','middle');
        t.setAttribute('class','connector-label');
        t.textContent=conn.label;g.appendChild(t);
      });
    
  nodes.forEach(node => {
  const group = document.createElementNS('http://www.w3.org/2000/svg', 'g');
  group.setAttribute('transform', `translate(${node.x},${node.y})`);
  group.style.cursor = 'pointer';
  group.addEventListener('click', () => showModal(node));

  let width = 180, height = 84;

  // === SHAPE ===
  let shapeEl;
  if (node.shape === 'circle') {
    shapeEl = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
    shapeEl.setAttribute('r', 48);
    width = height = 96;
  } else if (node.shape === 'oval') {
    shapeEl = document.createElementNS('http://www.w3.org/2000/svg', 'ellipse');
    shapeEl.setAttribute('rx', 70);
    shapeEl.setAttribute('ry', 36);
    width = 140;
    height = 72;
  } else {
    shapeEl = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
    shapeEl.setAttribute('x', -90);
    shapeEl.setAttribute('y', -42);
    shapeEl.setAttribute('width', 180);
    shapeEl.setAttribute('height', 84);
    shapeEl.setAttribute('rx', 12);
  }

  shapeEl.setAttribute('fill', node.color);
  shapeEl.setAttribute('class', 'node-shape');
  group.appendChild(shapeEl);

  // === EMOJI dentro del nodo ===
  const emoji = document.createElementNS('http://www.w3.org/2000/svg', 'text');
  emoji.textContent = node.emoji || '';
  emoji.setAttribute('text-anchor', 'start');
  emoji.setAttribute('x', -width / 2 + 10);
  emoji.setAttribute('y', -height / 2 + 20);
  emoji.setAttribute('class', 'emoji-badge');
  group.appendChild(emoji);

  // === LABEL centrado ===
  const fo = document.createElementNS('http://www.w3.org/2000/svg', 'foreignObject');
  fo.setAttribute('x', -width / 2);
  fo.setAttribute('y', -height / 2);
  fo.setAttribute('width', width);
  fo.setAttribute('height', height);

  const div = document.createElement('div');
  div.style.width = '100%';
  div.style.height = '100%';
  div.style.display = 'flex';
  div.style.flexDirection = 'column';
  div.style.alignItems = 'center';
  div.style.justifyContent = 'center';
 div.style.fontFamily = 'Quicksand, sans-serif';
div.style.fontSize = '14px';
div.style.fontWeight = '700';
  div.style.textAlign = 'center';
  div.style.color = '#071126';
  div.style.lineHeight = '1.2';
  div.textContent = node.label;

  fo.appendChild(div);
  group.appendChild(fo);

  // === Animaci√≥n hover ===
  group.addEventListener('mouseenter', () => {
    group.style.transition = 'transform 0.3s ease';
    group.style.transform = 'scale(1.1)';
  });
  group.addEventListener('mouseleave', () => {
    group.style.transform = 'scale(1)';
  });

  g.appendChild(group);
});

svg.appendChild(g);

    function showModal(node){
      const modalBody=document.getElementById('modalBody');
      const info=node.info;
      document.getElementById('modalTitle').textContent=info.title;
      document.getElementById('modalEmoji').textContent=node.emoji;
      modalBody.innerHTML=`

        <p>${info.description}</p>
        <ul>${info.details.map(d=>`<li>${d}</li>`).join('')}</ul>
      `;
      document.getElementById('modal').classList.add('active');
    }
    function closeModal(){
      document.getElementById('modal').classList.remove('active');
    }

    document.getElementById('modalClose').addEventListener('click',closeModal);
    document.getElementById('modalBackdrop').addEventListener('click',closeModal);

    const instr = document.getElementById('instructions');
const minBtn = document.getElementById('minimizeBtn');
let collapsed = false;

minBtn.addEventListener('click', (e) => { e.stopPropagation();

  collapsed = !collapsed;

  if (collapsed) {
    instr.classList.add('collapsed');
  } else {
    instr.classList.remove('collapsed');
  }
});

// Permite expandir haciendo clic sobre el c√≠rculo verde
instr.addEventListener('click', () => {
  if (collapsed) {
    collapsed = false;
    instr.classList.remove('collapsed');
  }
});


    function zoomIn(){scale=Math.min(scale+0.2,3);updateZoom();drawMap();}
    function zoomOut(){scale=Math.max(scale-0.2,0.6);updateZoom();drawMap();}
    function resetView(){scale=1;panX=0;panY=0;updateZoom();drawMap();}
    function updateZoom(){document.getElementById('zoomPercent').textContent=Math.round(scale*100);}
wrapper.addEventListener('mousedown',e=>{
  if(e.target.closest('.node'))return;
  isDragging=true;
  wrapper.classList.add('dragging');
  dragStartX=e.clientX-panX;
  dragStartY=e.clientY-panY;
});    window.addEventListener('mousemove',e=>{if(isDragging){panX=e.clientX-dragStartX;panY=e.clientY-dragStartY;drawMap();}});
window.addEventListener('mouseup',()=>{
  isDragging=false;
  wrapper.classList.remove('dragging');
});    window.addEventListener('keydown',e=>{if(e.key==='Escape')closeModal();});

    updateZoom();drawMap();
  </script>
</body>
</html>
